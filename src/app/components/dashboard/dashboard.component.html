<div class="dashboard-container">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      <h1>Expense Tracker</h1>
      <div class="user-info">
        <span class="username">{{ currentUser?.username }}</span>
        <button class="btn btn-logout" (click)="logout()">Logout</button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <div class="dashboard-content">
    <!-- Summary Cards -->
    <div class="summary-section">
      <div class="summary-card total">
        <h3>Total Expenses</h3>
        <p class="amount">â‚¹{{ totalExpenses.toFixed(2) }}</p>
      </div>
      <div class="summary-card personal">
        <h3>Personal</h3>
        <p class="amount">â‚¹{{ personalTotal.toFixed(2) }}</p>
      </div>
      <div class="summary-card organizational">
        <h3>Organizational</h3>
        <p class="amount">â‚¹{{ organizationalTotal.toFixed(2) }}</p>
      </div>
    </div>

    <!-- Filters Section -->
    <div class="filters-section">
      <h2>Filters</h2>
      <div class="filters-grid">
        <div class="filter-group">
          <label>Type</label>
          <select [(ngModel)]="selectedType" class="form-control">
            <option value="">All Types</option>
            <option [value]="ExpenseType.PERSONAL">Personal</option>
            <option [value]="ExpenseType.ORGANIZATIONAL">Organizational</option>
          </select>
        </div>

        <div class="filter-group">
          <label>Category</label>
          <select [(ngModel)]="selectedCategoryId" class="form-control">
            <option [ngValue]="null">All Categories</option>
            <option *ngFor="let category of categories" [ngValue]="category.categoryId">
              {{ category.name }}
            </option>
          </select>
        </div>

        <div class="filter-group">
          <label>Start Date</label>
          <input 
            type="date" 
            [(ngModel)]="startDate" 
            (ngModelChange)="onStartDateChange()"
            class="form-control" 
            [max]="endDate || maxDate" />
        </div>

        <div class="filter-group">
          <label>End Date</label>
          <input 
            type="date" 
            [(ngModel)]="endDate" 
            (ngModelChange)="onEndDateChange()"
            class="form-control" 
            [min]="startDate"
            [max]="maxDate" />
        </div>
      </div>

      <div class="filter-actions">
        <button class="btn btn-primary" (click)="applyFilters()">Apply Filters</button>
        <button class="btn btn-secondary" (click)="clearFilters()">Clear</button>
      </div>
    </div>

    <!-- Chart Section -->
    <div class="chart-section" *ngIf="!loading && expenses.length > 0">
      <h2>Expense Visualization</h2>
      <div class="chart-container">
        <canvas #expenseChart></canvas>
      </div>
    </div>

    <!-- Expenses Section -->
    <div class="expenses-section">
      <div class="section-header">
        <h2>Expenses</h2>
        <button class="btn btn-success" (click)="navigateToAddExpense()">
          + Add Expense
        </button>
      </div>

      <div *ngIf="loading" class="loading-spinner">
        <div class="spinner"></div>
        <p>Loading expenses...</p>
      </div>

      <div *ngIf="!loading && expenses.length === 0" class="no-expenses">
        <p>No expenses found. Click "Add Expense" to create one.</p>
      </div>

      <div *ngIf="!loading && expenses.length > 0" class="expenses-table-container">
        <table class="expenses-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Description</th>
              <th>Category</th>
              <th>Type</th>
              <th>Amount</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let expense of expenses">
              <td>{{ expense.expenseDate }}</td>
              <td>{{ expense.description }}</td>
              <td>{{ expense.categoryName }}</td>
              <td>
                <span class="badge" [class.badge-personal]="expense.expenseType === ExpenseType.PERSONAL"
                  [class.badge-organizational]="expense.expenseType === ExpenseType.ORGANIZATIONAL">
                  {{ expense.expenseType }}
                </span>
              </td>
              <td class="amount-cell">â‚¹{{ expense.amount.toFixed(2) }}</td>
              <td class="actions-cell">
                <button class="btn-icon btn-edit" (click)="navigateToEditExpense(expense.expenseId)" title="Edit">
                  âœŽ
                </button>
                <button class="btn-icon btn-delete" (click)="deleteExpense(expense.expenseId)" title="Delete">
                  ðŸ—‘
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>